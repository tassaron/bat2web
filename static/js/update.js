window.onload = function () {
    var input = document.getElementById('user_input');
    input.focus();
    input.select();
    input.addEventListener("keyup", function (event) {
        // Number 13 is the "Enter" key on the keyboard
        if (event.keyCode === 13) {
            document.getElementById("submit").click();
        }
    });
};

function quit() {
    window.location.replace(`${window.location.origin}/quit`)
}

function update() {
    var hint = document.getElementById('hint');
    var content = document.getElementById('content');
    var input = document.getElementById('user_input');
    fetch(
        `${window.location.origin}/input`,
        {
            method: "POST",
            credentials: "same-origin",
            cache: "no-cache",
            body: JSON.stringify(input.value),
            headers: new Headers({
                "content-type": "application/json",
            })
        }
    ).then(function (response) {
        if (input.value == "quit") { quit() }
        input.value = "";
        response.json().then(function (data) {
            if (data["bat"] !== null) {
                content.innerText = data["html"];
                hint.innerHTML = `generated by <a href="https://github.com/tassaron/batchfile.py/blob/main/games/funtimes/${data['bat']}">${data['bat']}</a>, a batch file written in 2008`;
            }
        });
    });
};
